<div class="flex-1 bg-[#151719] min-h-screen overflow-y-auto p-8 font-mono text-gray-300">

    <div class="mb-8 border-b border-[#2f3136] pb-6 flex justify-between items-end">
        <div>
            <h1 class="text-2xl font-bold text-white mb-2 flex items-center">
                <span class="text-green-400 mr-3">âžœ</span> 
                <span class="text-blue-400 mr-2">~</span> 
                ls -la /repositories
            </h1>
            <p class="text-gray-500 text-sm pl-8">// Total indexed repositories: <span class="text-blue-400 font-bold">{{ totalItems }}</span></p>
        </div>

        <button (click)="syncGitHub()" [disabled]="isSyncing" class="cursor-pointer flex items-center gap-2 px-4 py-2 border border-blue-500/30 bg-blue-500/10 text-blue-400 hover:bg-blue-500 hover:text-black rounded transition-all group font-bold tracking-wider text-sm uppercase">
            <svg class="w-4 h-4 group-hover:animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            {{ isSyncing ? '[ Syncing... ]' : '[ Sync_GitHub ]' }}
        </button>
    </div>

    <div class="bg-[#1e2124] border border-[#2f3136] rounded overflow-hidden text-sm shadow-2xl">
        
        <div class="grid grid-cols-12 gap-4 p-4 border-b border-[#2f3136] text-gray-500 text-xs uppercase tracking-wider bg-[#1a1c1e] font-bold">
            <div class="col-span-1 pl-2 text-center">ACCESS</div>
            <div class="col-span-4">REPOSITORY_NAME</div>
            <div class="col-span-2">TECH_STACK</div>
            <div class="col-span-2">PRIVACI_STATUS</div>
            <div class="col-span-2">LAST_SCANNED</div>
            <div class="col-span-1 text-right pr-2">EXEC</div>
        </div>

        <div class="divide-y divide-[#2f3136]">
            @for (repo of repos$ | async; track repo.id) {
                
                <div class="grid grid-cols-12 gap-4 p-4 hover:bg-[#2f3136]/40 transition-colors items-center group">
                    
                    <div class="col-span-1 flex justify-center text-gray-500">
                        @if (repo.is_private) {
                            <span class="text-yellow-500/70" title="Private Repository">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                            </span>
                        } @else {
                            <span class="text-green-500/50" title="Public Repository">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            </span>
                        }
                    </div>

                    <div class="col-span-4">
                        <a [routerLink]="['/repo', repo.github_repo_id]" class="text-blue-300 font-bold hover:text-blue-400 hover:underline transition-colors block truncate">
                            {{ repo.name }}
                        </a>
                    </div>

                    <div class="col-span-2 text-gray-400 text-xs flex items-center">
                        <span class="px-2 py-0.5 rounded border border-[#2f3136] bg-[#151719]">{{ repo.main_language }}</span>
                    </div>

                    <div class="col-span-2 flex items-center">
                        @switch (repo.scan_status) {
                            @case ('SAFE') {
                                <span class="text-green-400 text-xs flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full bg-green-500"></div> Safe</span>
                            }
                            @case ('WARNING') {
                                <span class="text-yellow-400 text-xs flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full bg-yellow-400"></div> Warning</span>
                            }
                            @case ('CRITICAL') {
                                <span class="text-red-400 text-xs flex items-center gap-2 font-bold animate-pulse"><div class="w-1.5 h-1.5 rounded-full bg-red-500"></div> Critical</span>
                            }
                            @case ('UNSCANNED') {
                                <span class="text-gray-500 text-xs flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full border border-gray-500"></div> Unscanned</span>
                            }
                        }
                    </div>

                    <div class="col-span-2 text-gray-500 text-xs font-sans">
                        @if (repo.last_scanned_at) {
                            {{ repo.last_scanned_at | date:'MMM d, y' }}
                        } @else {
                            --
                        }
                    </div>

                    <div class="col-span-1 text-right pr-2">
                        @if (repo.scan_status === 'UNSCANNED') {
                            <button class="cursor-pointer text-[0.65rem] px-2 py-1 bg-green-500/10 text-green-400 border border-green-500/30 rounded hover:bg-green-500 hover:text-black transition-colors uppercase tracking-wider">
                                Scan
                            </button>
                        } @else {
                            <a [routerLink]="['/repo', repo.github_repo_id]" class="cursor-pointer text-[0.65rem] px-2 py-1 bg-[#2f3136] text-gray-300 border border-gray-600 rounded hover:bg-blue-500 hover:border-blue-500 hover:text-white transition-colors uppercase tracking-wider inline-block">
                                View
                            </a>
                        }
                    </div>
                </div>

            } @empty {
                <div class="p-8 text-center text-gray-500 font-mono text-xs">
                    > Error: Directory is empty. Click [ Sync_GitHub ] to fetch repositories.
                </div>
            }
        </div>

    </div>
    
    <div class="mt-6 flex flex-col md:flex-row items-center justify-between text-xs font-mono border-t border-[#2f3136] pt-4 gap-4">
        <div class="text-gray-500 select-none">
            // display_range: [ <span class="text-blue-400 font-bold">{{ startIndex }}</span> ... <span class="text-blue-400 font-bold">{{ endIndex }}</span> ] of <span class="text-blue-400 font-bold">{{ totalItems }}</span> total
        </div>
        
        <div class="flex items-center gap-3">
            <button (click)="prevPage()" [disabled]="currentPage === 1" 
                    class="cursor-pointer px-4 py-2 bg-[#1e2124] border border-[#2f3136] text-gray-400 hover:text-white hover:bg-[#2f3136] disabled:opacity-30 disabled:cursor-not-allowed rounded transition-all uppercase tracking-wider flex items-center gap-2 group">
                <span class="text-blue-500 group-hover:-translate-x-1 transition-transform"><</span> Prev
            </button>
            
            <div class="text-gray-500 bg-[#151719] px-4 py-2 rounded border border-[#2f3136] select-none shadow-inner">
                page <span class="text-white font-bold">{{ currentPage }}</span> / {{ totalPages }}
            </div>
            
            <button (click)="nextPage()" [disabled]="currentPage === totalPages" 
                    class="cursor-pointer px-4 py-2 bg-[#1e2124] border border-[#2f3136] text-gray-400 hover:text-white hover:bg-[#2f3136] disabled:opacity-30 disabled:cursor-not-allowed rounded transition-all uppercase tracking-wider flex items-center gap-2 group">
                Next <span class="text-blue-500 group-hover:translate-x-1 transition-transform">></span>
            </button>
        </div>

    </div>
</div>